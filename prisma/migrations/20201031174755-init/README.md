# Migration `20201031174755-init`

This migration has been generated by woony at 11/1/2020, 2:47:55 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `Comment` DROP FOREIGN KEY `Comment_ibfk_3`

ALTER TABLE `Post` DROP FOREIGN KEY `Post_ibfk_1`

ALTER TABLE `Comment` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Post` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201031102750-init..20201031174755-init
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 model HomeAD {
   id        String    @id @default(cuid())
@@ -37,8 +37,10 @@
   UserDoctor   UserDoctor[]   @relation("userDoctorId")
   UserMarketer UserMarketer[] @relation("userMarketId")
   likeProduct  likeProduct[]
+  Post         Post[]         @relation("PostAuthor")
+  Comment      Comment[]      @relation("CommentAuthor")
 }
 model UserDoctor {
   id     String @id @default(cuid())
@@ -49,10 +51,8 @@
   medical_id    String
   medical_certi String
   likeProducts likeProduct[]
-  Post         Post[]        @relation("PostAuthor")
-  Comment      Comment[]     @relation("CommentAuthor")
   @@unique([medical_id, medical_cate])
 }
@@ -69,13 +69,13 @@
   product Product[]
 }
 model Post {
-  id        String     @id @default(cuid())
-  user      UserDoctor @relation(name: "PostAuthor", fields: [userId], references: [userId])
+  id        String   @id @default(cuid())
+  user      User     @relation(name: "PostAuthor", fields: [userId], references: [id])
   userId    String
-  updatedAt DateTime   @default(now()) @updatedAt
-  createdAt DateTime   @default(now())
+  updatedAt DateTime @default(now()) @updatedAt
+  createdAt DateTime @default(now())
   category   String
   title      String
   content    String
@@ -84,13 +84,13 @@
   comments   Comment[]
 }
 model Comment {
-  id        String     @id @default(cuid())
-  user      UserDoctor @relation(name: "CommentAuthor", fields: [userId], references: [userId])
+  id        String   @id @default(cuid())
+  user      User     @relation(name: "CommentAuthor", fields: [userId], references: [id])
   userId    String
-  createdAt DateTime   @default(now())
-  updatedAt DateTime   @default(now()) @updatedAt
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now()) @updatedAt
   text   String
   post   Post   @relation(fields: [postId], references: [id])
   postId String
```


